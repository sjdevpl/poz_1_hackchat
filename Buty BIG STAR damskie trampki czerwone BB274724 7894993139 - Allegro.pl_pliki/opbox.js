!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t,n){"use strict";function r(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(0===i.length)return e=t;var s=[].concat(i),u=s.shift();return e="object"!==(void 0===e?"undefined":o(e))?{}:e,e[u]=r.apply(void 0,[e[u],t].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(s))),e}function i(e,t){return Object.keys(e).reduce(function(n,r){var a=e[r],s="object"===(void 0===a?"undefined":o(a))?i(a,t):a;return n[t.find(function(e){return r.toLowerCase()===e.toLowerCase()})||r]=s,n},{})}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.map=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments[1],n=arguments[2],r={};return Object.keys(e).forEach(function(i){r[i]=t.call(n,e[i],i,e)}),r},t.isObject=function(e){return"object"===(void 0===e?"undefined":o(e))&&null!==e},t.isUndefined=function(e){return void 0===e},t.isFunction=function(e){return"function"==typeof e},t.isEmpty=function(e){return null===e||"object"!==(void 0===e?"undefined":o(e))||0===Object.keys(e).length},t.querySelectorAll=function(e,t){return Array.prototype.slice.call(e.querySelectorAll(t))},t.noop=function(){},t.debounce=function(e,t,n){var r=void 0;return function(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];var s=this,u=n&&!r;return clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(s,o)},t),u&&e.apply(s,o),r}},t.createEvent=function(e,t){var n=t.document.createEvent("CustomEvent");return n.initCustomEvent(e,!0,!0,{}),n},t.concat=function(e,t){return e.concat(t)},t.find=function(e,t){for(var n=0,r=e.length;n<r;n+=1)if(t(e[n],n,e))return e[n];return null},t.assignToTarget=r,t.normalizeObjectKeys=i,t.dropUnknownKeys=function(e,t){Object.keys(e).forEach(function(n){t.includes(n)||delete e[n]})}},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataSources=t}return i(e,[{key:"resolve",value:function(e,t){var n=e.value;if("DATA_SOURCE"===e.type){var i=this.dataSources[n];return Object.assign({},i&&i.data&&r({},t,i.data),i&&!(0,o.isEmpty)(i.metadata)&&r({},t+".$meta",i.metadata))}return r({},t,n)}}]),e}();t.default=a},function(e,t,n){(function(e,n){function r(e,t){return"__proto__"==t?void 0:e[t]}function i(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function o(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function s(e){var t=this.__data__=new o(e);this.size=t.size}function u(e,t,n){(void 0===n||g(e[t],n))&&(void 0!==n||t in e)||l(e,t,n)}function c(e,t){for(var n=e.length;n--;)if(g(e[n][0],t))return n;return-1}function l(e,t,n){"__proto__"==t&&ye?ye(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function f(e){return null==e?void 0===e?L:V:pe&&pe in Object(e)?function(e){var t=ne.call(e,pe),n=e[pe];try{e[pe]=void 0;var r=!0}catch(e){}var i=ie.call(e);r&&(t?e[pe]=n:delete e[pe]);return i}(e):function(e){return ie.call(e)}(e)}function d(e){return P(e)&&f(e)==A}function h(e,t,n,i,o){e!==t&&Pe(t,function(a,c){if(x(a))o||(o=new s),function(e,t,n,i,o,a,s){var c=r(e,n),d=r(t,n),h=s.get(d);if(h)return void u(e,n,h);var v=a?a(c,d,n+"",e,t,s):void 0,p=void 0===v;if(p){var y=Oe(d),k=!y&&je(d),_=!y&&!k&&Ce(d);v=d,y||k||_?Oe(c)?v=c:!function(e){return P(e)&&b(e)}(c)?k?(p=!1,v=function(e,t){if(t)return e.slice();var n=e.length,r=le?le(n):new e.constructor(n);return e.copy(r),r}(d,!0)):_?(p=!1,v=function(e,t){var n=t?function(e){var t=new e.constructor(e.byteLength);return new ce(t).set(new ce(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(d,!0)):v=[]:v=function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(c):function(e){if(!P(e)||f(e)!=N)return!1;var t=fe(e);if(null===t)return!0;var n=ne.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&te.call(n)==oe}(d)||_e(d)?(v=c,_e(c)?v=function(e){return function(e,t,n,r){var i=!n;n||(n={});var o=-1,a=t.length;for(;++o<a;){var s=t[o],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),i?l(n,s,u):function(e,t,n){var r=e[t];ne.call(e,t)&&g(r,n)&&(void 0!==n||t in e)||l(e,t,n)}(n,s,u)}return n}(e,E(e))}(c):(!x(c)||i&&w(c))&&(v=function(e){return"function"!=typeof e.constructor||m(e)?{}:xe(fe(e))}(d))):p=!1}p&&(s.set(d,v),o(v,d,i,a,s),s.delete(d));u(e,n,v)}(e,t,c,n,h,i,o);else{var d=i?i(r(e,c),a,c+"",e,t,o):void 0;void 0===d&&(d=a),u(e,c,d)}},E)}function v(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function p(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!x(e)||!!re&&re in e)&&(w(e)?ae:U).test(function(e){if(null!=e){try{return te.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}(n)?n:void 0}function y(e,t){var n=typeof e;return!!(t=null==t?T:t)&&("number"==n||"symbol"!=n&&z.test(e))&&e>-1&&e%1==0&&e<t}function m(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)}function g(e,t){return e===t||e!=e&&t!=t}function b(e){return null!=e&&k(e.length)&&!w(e)}function w(e){if(!x(e))return!1;var t=f(e);return t==R||t==B||t==M||t==I}function k(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=T}function x(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function P(e){return null!=e&&"object"==typeof e}function E(e){return b(e)?function(e,t){var n=Oe(e),r=!n&&_e(e),i=!n&&!r&&je(e),o=!n&&!r&&!i&&Ce(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=s.length;for(var c in e)!t&&!ne.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||y(c,u))||s.push(c);return s}(e,!0):function(e){if(!x(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=m(e),n=[];for(var r in e)("constructor"!=r||!t&&ne.call(e,r))&&n.push(r);return n}(e)}function _(e){return e}var O=200,j="__lodash_hash_undefined__",C=800,S=16,T=9007199254740991,A="[object Arguments]",M="[object AsyncFunction]",R="[object Function]",B="[object GeneratorFunction]",V="[object Null]",N="[object Object]",I="[object Proxy]",L="[object Undefined]",U=/^\[object .+?Constructor\]$/,z=/^(?:0|[1-9]\d*)$/,W={};W["[object Float32Array]"]=W["[object Float64Array]"]=W["[object Int8Array]"]=W["[object Int16Array]"]=W["[object Int32Array]"]=W["[object Uint8Array]"]=W["[object Uint8ClampedArray]"]=W["[object Uint16Array]"]=W["[object Uint32Array]"]=!0,W[A]=W["[object Array]"]=W["[object ArrayBuffer]"]=W["[object Boolean]"]=W["[object DataView]"]=W["[object Date]"]=W["[object Error]"]=W[R]=W["[object Map]"]=W["[object Number]"]=W[N]=W["[object RegExp]"]=W["[object Set]"]=W["[object String]"]=W["[object WeakMap]"]=!1;var D="object"==typeof e&&e&&e.Object===Object&&e,q="object"==typeof self&&self&&self.Object===Object&&self,H=D||q||Function("return this")(),F="object"==typeof t&&t&&!t.nodeType&&t,$=F&&"object"==typeof n&&n&&!n.nodeType&&n,G=$&&$.exports===F,J=G&&D.process,X=function(){try{return J&&J.binding&&J.binding("util")}catch(e){}}(),K=X&&X.isTypedArray,Y=Array.prototype,Q=Function.prototype,Z=Object.prototype,ee=H["__core-js_shared__"],te=Q.toString,ne=Z.hasOwnProperty,re=function(){var e=/[^.]+$/.exec(ee&&ee.keys&&ee.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ie=Z.toString,oe=te.call(Object),ae=RegExp("^"+te.call(ne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),se=G?H.Buffer:void 0,ue=H.Symbol,ce=H.Uint8Array,le=se?se.allocUnsafe:void 0,fe=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),de=Object.create,he=Z.propertyIsEnumerable,ve=Y.splice,pe=ue?ue.toStringTag:void 0,ye=function(){try{var e=p(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),me=se?se.isBuffer:void 0,ge=Math.max,be=Date.now,we=p(H,"Map"),ke=p(Object,"create"),xe=function(){function e(){}return function(t){if(!x(t))return{};if(de)return de(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();i.prototype.clear=function(){this.__data__=ke?ke(null):{},this.size=0},i.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},i.prototype.get=function(e){var t=this.__data__;if(ke){var n=t[e];return n===j?void 0:n}return ne.call(t,e)?t[e]:void 0},i.prototype.has=function(e){var t=this.__data__;return ke?void 0!==t[e]:ne.call(t,e)},i.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ke&&void 0===t?j:t,this},o.prototype.clear=function(){this.__data__=[],this.size=0},o.prototype.delete=function(e){var t=this.__data__,n=c(t,e);return!(n<0||(n==t.length-1?t.pop():ve.call(t,n,1),--this.size,0))},o.prototype.get=function(e){var t=this.__data__,n=c(t,e);return n<0?void 0:t[n][1]},o.prototype.has=function(e){return c(this.__data__,e)>-1},o.prototype.set=function(e,t){var n=this.__data__,r=c(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},a.prototype.clear=function(){this.size=0,this.__data__={hash:new i,map:new(we||o),string:new i}},a.prototype.delete=function(e){var t=v(this,e).delete(e);return this.size-=t?1:0,t},a.prototype.get=function(e){return v(this,e).get(e)},a.prototype.has=function(e){return v(this,e).has(e)},a.prototype.set=function(e,t){var n=v(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},s.prototype.clear=function(){this.__data__=new o,this.size=0},s.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},s.prototype.get=function(e){return this.__data__.get(e)},s.prototype.has=function(e){return this.__data__.has(e)},s.prototype.set=function(e,t){var n=this.__data__;if(n instanceof o){var r=n.__data__;if(!we||r.length<O-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(r)}return n.set(e,t),this.size=n.size,this};var Pe=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===n(o[u],u,o))break}return t}}(),Ee=function(e){var t=0,n=0;return function(){var r=be(),i=S-(r-n);if(n=r,i>0){if(++t>=C)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ye?function(e,t){return ye(e,"toString",{configurable:!0,enumerable:!1,value:function(e){return function(){return e}}(t),writable:!0})}:_),_e=d(function(){return arguments}())?d:function(e){return P(e)&&ne.call(e,"callee")&&!he.call(e,"callee")},Oe=Array.isArray,je=me||function(){return!1},Ce=K?function(e){return function(t){return e(t)}}(K):function(e){return P(e)&&k(e.length)&&!!W[f(e)]},Se=function(e){return function(e,t){return Ee(function(e,t,n){return t=ge(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=ge(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}(e,void 0,_),e+"")}(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&function(e,t,n){if(!x(n))return!1;var r=typeof t;return!!("number"==r?b(n)&&y(t,n.length):"string"==r&&t in n)&&g(n[t],e)}(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t})}(function(e,t,n){h(e,t,n)});n.exports=Se}).call(t,n(25),n(26)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.targetWindow,r=t.config,i=t.componentRegistry,o=t.Box,a=t.ChildBox,s=t.Slot;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetWindow=n,this.config=r,this.componentRegistry=i,this.Box=o,this.ChildBox=a,this.Slot=s}return r(e,[{key:"document",get:function(){return this.targetWindow.document}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(16)),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.boxes,r=void 0===n?[]:n,i=t.dataSources,a=void 0===i?{}:i,s=t.meta,u=void 0===s?{}:s,c=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var l=new o.default(c,a),f=l.Box;this.pageContext=l,this.boxes=r.map(function(e){return new f(e,l)}),this.meta=u}return i(e,[{key:"render",value:function(){this.mountBoxes(),this.unmountRedundantBoxes(),this.updateMetaRobots()}},{key:"mountBoxes",value:function(){this.boxes.forEach(function(e){return e.mount()})}},{key:"unmountRedundantBoxes",value:function(){var e=this,t=this.pageContext,n=t.config,r=t.Box,i=n.lazyBoxNames,o=this.childBoxes.map(function(e){return e.name});i.forEach(function(t){if(o.indexOf(t)<0){new r({name:t},e.pageContext).unmount()}})}},{key:"updateMetaRobots",value:function(){var e=this.pageContext.document.querySelector('head meta[name="robots"]');e&&this.meta&&e.setAttribute("content",[this.meta.noindexCondition?"noindex":"index",this.meta.nofollowCondition?"nofollow":"follow"].join(", "))}},{key:"childBoxes",get:function(){var e;return(e=[]).concat.apply(e,r(this.boxes.map(function(e){var t;return(t=[e]).concat.apply(t,r(e.childBoxes))})))}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,r=t.slug,i=t.prototypeId,o=t.version,a=t.slots,s=void 0===a?[]:a,u=t.parameters,c=void 0===u?[]:u,l=t.analyticsTags,f=void 0===l?[]:l,d=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var h=d.Slot;this.pageContext=d,this.name=n,this.slug=r,this.prototypeId=i,this.version=o,this.analyticsTags=f.join(","),this.slots=s.map(function(e){return new h(e,d)}),this.parameters=c}return r(e,[{key:"getNode",value:function(){return this.pageContext.document.querySelector(this.selector)}},{key:"renderSlots",value:function(){return this.slots.reduce(function(e,t){return Object.assign(e,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t.name,t.render()))},{})}},{key:"render",value:function(){if(!this.component)return null;var e=this.renderSlots();return this.component.render(this.componentProps,e)}},{key:"mount",value:function(){var e=this.pageContext.targetWindow,t=this.getNode();if(t){var n=this.render();n&&(t.innerHTML=n,e.opbox.boxViewsMarker.markBoxAsRendered(t),this.didMount())}}},{key:"unmount",value:function(){var e=this.getNode();e&&(e.innerHTML="")}},{key:"didMount",value:function(){this.component&&(this.slots.forEach(function(e){e.didMount()}),this.component.didMount(this.componentProps))}},{key:"didUnmount",value:function(){this.component&&(this.slots.forEach(function(e){e.didUnmount()}),this.component.didUnmount(this.componentProps))}},{key:"resolvedParameters",get:function(){var e=this.pageContext.parameterResolver;return this.parameters.reduce(function(t,n){return Object.assign(t,e.resolve(n,n.name))},{})}},{key:"componentProps",get:function(){return Object.assign({},this.resolvedParameters,{"$box.name":this.name,"$box.slug":this.slug,"$box.lazy":!1})}},{key:"selector",get:function(){return'[data-box-name="'+this.name+'"]'}},{key:"childBoxes",get:function(){var e;return(e=[]).concat.apply(e,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.slots.map(function(e){return e.childBoxes})))}},{key:"component",get:function(){return this.pageContext.componentRegistry.find(this.prototypeId,this.version)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.data,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=n,this.headers=r}return r(e,[{key:"valid",get:function(){return(0,i.isObject)(this.data)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.boxes,r=void 0===n?{}:n,i=t.dataSources,a=void 0===i?{}:i,s=t.meta,u=void 0===s?{}:s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.boxes=r,this.dataSources=a,this.meta=u,this.parameterResolver=new o.default(this.dataSources)}return r(e,[{key:"resolved",get:function(){return{boxes:this.resolvedBoxes,dataSources:this.dataSources,meta:this.meta}}},{key:"resolvedBoxes",get:function(){var e=this;return(0,i.map)(this.boxes,function(t){var n=Object.keys(t).reduce(function(n,r){var i=e.parameterResolver.resolve(t[r],r);return Object.assign(n,i)},{});return Object.assign(n,e.pageProperties)})}},{key:"pageProperties",get:function(){var e=this;return Object.keys(this.meta).filter(function(e){return 0===e.indexOf("$page.")}).reduce(function(t,n){return Object.assign(t,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,e.meta[n]))},{})}}],[{key:"createEmpty",value:function(){return new e}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0).debounce,o=t.SEEN_ATTRIBUTE_NAME="data-seen",a=t.VISIBLE_FOR_ATTRIBUTE_NAME="data-visible-for",s=t.BOX_VIEW_ENABLED_ATTRIBUTE_NAME="data-analytics-enabled",u=t.BOX_VIEW_PROXIED_ATTRIBUTE_NAME="data-analytics-proxied",c=function(e){return Array.prototype.slice.call(e)},l=function(){function e(t){var n=t.targetWindow,r=t.boxes,o=void 0===r?[]:r,a=t.significantElementSizePercentage,s=void 0===a?.75:a,u=t.timeoutValue,c=void 0===u?500:u,l=t.debounceTimeoutValue,f=void 0===l?20:l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetWindow=n,this.config={timeoutValue:c,debounceTimeoutValue:f,significantElementSizePercentage:s},this.resetState(),this.boxes=o.length?o:e.getBoxViewEnabledNodes(n.document),this.visibleElements=[],this.scrollHandlerWithContext=this.scrollHandler.bind(this),this.scrollEndHandler=i(this.resetCurrentlyVisibleElementsAfterScroll,this.config.debounceTimeoutValue),this.resizeEndHandler=i(this.resizeHandler.bind(this),this.config.debounceTimeoutValue),this.resetCurrentlyVisibleElementsOnTimeout=i(this.resetCurrentlyVisibleElements.bind(this),this.config.debounceTimeoutValue),this.markCurrentlyVisibleElementsAsSeenOnTimeout=i(this.markCurrentlyVisibleElementsAsSeen.bind(this),this.config.timeoutValue)}return r(e,[{key:"setUserViewport",value:function(){this.state.userViewport=e.getUserViewport(this.targetWindow)}},{key:"resetState",value:function(){var t=(new Date).getTime();this.state={isScrolling:!1,scrollStartTime:t,counterStartTime:t,userViewport:e.getUserViewport(this.targetWindow)}}},{key:"createEvent",value:function(e){var t=this.targetWindow.document.createEvent("CustomEvent");return t.initCustomEvent(e,!0,!0,{}),t}},{key:"isSignificantPartOfElementVisible",value:function(t){var n=t.right-t.left,r=t.bottom-t.top,i=e.getElementVisibileDimensionLength(t.left,t.right,this.state.userViewport.width,n);return e.getElementVisibileDimensionLength(t.top,t.bottom,this.state.userViewport.height,r)*i/(n*r)>this.config.significantElementSizePercentage}},{key:"putVisibleElementsToBuffer",value:function(){var t=!1,n=this.visibleElements.slice();this.visibleElements=[];for(var r=0;r<this.boxes.length;r+=1){var i=null;try{i=this.boxes[r].getBoundingClientRect()}catch(e){t=!0,this.boxes[r]=null}i&&(this.isSignificantPartOfElementVisible(i)?(this.visibleElements.push(this.boxes[r]),-1===n.indexOf(this.boxes[r])&&this.boxes[r].dispatchEvent(this.createEvent("inViewport"))):-1!==n.indexOf(this.boxes[r])&&this.boxes[r].dispatchEvent(this.createEvent("outOfViewport")))}t&&(this.boxes=this.boxes.filter(function(e){return null!==e}),e.getBoxViewEnabledNodes(this.targetWindow.document).forEach(this.addBox.bind(this)))}},{key:"markElementAsSeen",value:function(e,t){if(e){var n=parseInt(e.getAttribute(a),10)||0;(!e.getAttribute(o)&&n+t)>=this.config.timeoutValue&&(e.setAttribute(o,!0),e.dispatchEvent(this.createEvent("boxView"))),e.setAttribute(a,n+t)}}},{key:"markPreviouslyVisibleElementsAsSeen",value:function(){var e=this,t=(new Date).getTime();this.visibleElements.forEach(function(n){e.markElementAsSeen(n,t-e.state.counterStartTime)})}},{key:"markPreviouslyVisibleElementsAsSeenAfterScroll",value:function(){var e=this;this.visibleElements.forEach(function(t){e.markElementAsSeen(t,e.state.scrollStartTime-e.state.counterStartTime)})}},{key:"markCurrentlyVisibleElementsAsSeen",value:function(){var e=this;this.visibleElements.forEach(function(t){e.markElementAsSeen(t,e.config.timeoutValue)})}},{key:"resetCurrentlyVisibleElements",value:function(){this.markPreviouslyVisibleElementsAsSeen(),this.putVisibleElementsToBuffer(),this.markCurrentlyVisibleElementsAsSeenOnTimeout(),this.resetState()}},{key:"resetCurrentlyVisibleElementsAfterScroll",value:function(){this.markPreviouslyVisibleElementsAsSeenAfterScroll(),this.putVisibleElementsToBuffer(),this.markCurrentlyVisibleElementsAsSeenOnTimeout(),this.resetState()}},{key:"scrollHandler",value:function(){this.state.isScrolling||(this.state.scrollStartTime=(new Date).getTime(),this.state.isScrolling=!0),clearTimeout(this.markCurrentlyVisibleElementsAsSeenOnTimeout()),this.scrollEndHandler()}},{key:"resizeHandler",value:function(){this.setUserViewport(),this.resetCurrentlyVisibleElements()}},{key:"addBox",value:function(e){-1===this.boxes.indexOf(e)&&this.boxes.push(e)}},{key:"isBoxInViewport",value:function(e){return-1!==this.visibleElements.indexOf(e)}},{key:"clearAttributes",value:function(e){this.boxes.forEach(function(t){t&&t.matches(e)&&(t.removeAttribute(o),t.removeAttribute(a))})}},{key:"markBoxAsRendered",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n&&this.clearAttributes(n),t.getAttribute("data-analytics-enabled")&&this.addBox(t),e.getBoxViewEnabledNodes(t).forEach(this.addBox.bind(this)),this.resetCurrentlyVisibleElementsOnTimeout()}},{key:"markBoxAsVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.addBox(e),t?this.markElementAsSeen(e,this.config.timeoutValue):this.resetCurrentlyVisibleElementsOnTimeout()}},{key:"recursivelyMarkBoxAsVisible",value:function(t){var n=this;this.addBox(t),e.getBoxViewEnabledNodes(t).forEach(function(e){n.addBox(e)}),this.resetCurrentlyVisibleElementsOnTimeout()}},{key:"removeBox",value:function(e){this.boxes=this.boxes.filter(function(t){return t!==e})}},{key:"markBoxAsHidden",value:function(e){this.removeBox(e),this.resetCurrentlyVisibleElementsOnTimeout()}},{key:"recursivelyMarkBoxAsHidden",value:function(t){var n=this;this.removeBox(t),e.getBoxViewEnabledNodes(t).forEach(function(e){n.removeBox(e)}),this.resetCurrentlyVisibleElementsOnTimeout()}},{key:"trackBoxScroll",value:function(e){e.addEventListener("scroll",this.scrollHandlerWithContext)}},{key:"initialize",value:function(){this.targetWindow.addEventListener("scroll",this.scrollHandlerWithContext),this.targetWindow.addEventListener("resize",this.resizeEndHandler),this.resetCurrentlyVisibleElements()}},{key:"createAPI",value:function(){return{markBoxAsRendered:this.markBoxAsRendered.bind(this),markBoxAsVisible:this.markBoxAsVisible.bind(this),recursivelyMarkBoxAsVisible:this.recursivelyMarkBoxAsVisible.bind(this),markBoxAsHidden:this.markBoxAsHidden.bind(this),recursivelyMarkBoxAsHidden:this.recursivelyMarkBoxAsHidden.bind(this),trackBoxScroll:this.trackBoxScroll.bind(this),isBoxInViewport:this.isBoxInViewport.bind(this)}}}],[{key:"getBoxViewEnabledNodes",value:function(e){var t=c(e.querySelectorAll("["+s+"]")),n=c(e.querySelectorAll("["+u+"]")).map(function(e){return c(e.querySelectorAll("["+s+"]"))}).filter(function(e){return e.length}).reduce(function(e,t){return e.concat(t)},[]),r=n.filter(function(e,t){return n.indexOf(e)===t});return t.filter(function(e){return-1===r.indexOf(e)})}},{key:"getElementVisibileDimensionLength",value:function(e,t,n,r){return e>0?e<n?t<n?t-e:n-e:0:t<0?0:t<n?t:r}},{key:"getUserViewport",value:function(e){return{width:e.innerWidth,height:e.innerHeight}}}]),e}();t.default=l},function(e,t,n){e.exports=n(10)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.attach=void 0;var i=r(n(11)),o=new(r(n(12)).default)(window,new i.default,new i.default);o.run();t.attach=o.attach.bind(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastRequest=null}return i(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,{},t)}},{key:"post",value:function(e,t,n){return this.request("POST",e,t,n)}},{key:"put",value:function(e,t,n){return this.request("PUT",e,t,n)}},{key:"patch",value:function(e,t,n){return this.request("PATCH",e,t,n)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,{},t)}},{key:"request",value:function(t,n,r,i){var o=i.headers,a=void 0===o?{}:o,s=i.validateStatus,u=void 0===s?e.defaultValidateFunction:s,c=i.withCredentials,l=void 0!==c&&c,f=i.cancelLast,d=void 0!==f&&f,h=i.onUploadProgress,v=void 0===h?function(){}:h;d&&this.cancelLastRequest();var p=e.makeRequest(t,n,r,a,l,v);return this.lastRequest=p,e.toPromise(p,u)}},{key:"cancelLastRequest",value:function(){null!==this.lastRequest&&this.lastRequest.abort()}}],[{key:"makeRequest",value:function(t,n,r,i,o,a){var s=new XMLHttpRequest;return s.open(t,n,!0),Object.keys(i).forEach(function(e){s.setRequestHeader(e,i[e])}),s.withCredentials=o,s.upload&&s.upload.addEventListener("progress",a),s.send(e.serialize(t,r)),s}},{key:"toPromise",value:function(t,n){return new Promise(function(r,i){t.readyState===XMLHttpRequest.DONE?e.checkResponse(t,n,r,i):t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&e.checkResponse(t,n,r,i)}})}},{key:"serialize",value:function(e,t){return"POST"===e||"PUT"===e||"PATCH"===e?"object"!==(void 0===t?"undefined":r(t))||t instanceof Blob||t instanceof FormData?t:JSON.stringify(t):null}},{key:"checkResponse",value:function(t,n,r,i){var o=t.status,a=t.responseText,s=n(o),u={};try{u=JSON.parse(a)}catch(e){u=a}s?r({status:o,data:u,headers:e.parseHeaders(t.getAllResponseHeaders())}):i({status:o,data:u,message:"Request failed with status code "+o})}},{key:"defaultValidateFunction",value:function(e){return 200===e||201===e||202===e||204===e}},{key:"parseHeaders",value:function(e){var t={},n=void 0,r=void 0,i=void 0;return e.split("\n").forEach(function(e){i=e.indexOf(":"),n=e.substr(0,i).trim().toLowerCase(),r=e.substr(i+1).trim(),n&&(t[n]=t[n]?t[n]+", "+r:r)}),t}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=r(n(13)),a=r(n(14)),s=r(n(3)),u=r(n(4)),c=r(n(5)),l=r(n(17)),f=r(n(18)),d=r(n(19)),h=r(n(23)),v=r(n(24)),p=r(n(27)),y=r(n(28)),m=r(n(29)),g=r(n(8)),b=r(n(30)),w=r(n(31)),k=n(0),x=r(n(33)),P=r(n(35)),E=r(n(36)),_=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetWindow=t;var i=o.default.fromWindow(this.targetWindow),u=new a.default,k=new s.default({targetWindow:t,config:i,componentRegistry:u,Box:c.default,ChildBox:l.default,Slot:f.default}),x=new m.default({targetWindow:t,config:i}),P=new g.default({targetWindow:t}),_=new v.default({targetWindow:t,config:i,cookieMonsterClient:x,boxViewsMarker:P,sendPerformanceMetrics:this.sendPerformanceMetrics.bind(this)}),O=new h.default(k,_),j=new d.default({httpClient:n});this.config=i,this.componentRegistry=u,this.appContext=k,this.rawDataListenersRegistry=O,this.opboxWebClient=j,this.cookieMonsterClient=x,this.analytics=_,this.boxViewsMarker=P,this.navigation=new b.default({targetWindow:t,opboxWebClient:j,rawDataListenersRegistry:O}),this.component=new p.default({targetWindow:t}),this.edgeClient=new y.default({httpClient:r,config:i}),this.preferencesClient=new E.default({edgeClient:this.edgeClient,localStorage:this.targetWindow.localStorage}),this.uiTools=new w.default({targetWindow:t}),this.analytics.initialize(),this.navigation.initialize(),this.boxViewsMarker.initialize()}return i(e,[{key:"registerComponent",value:function(){var e;(e=this.componentRegistry).register.apply(e,arguments),this.page&&this.page.render()}},{key:"domReadyHelper",value:function(e){"loading"===this.targetWindow.document.readyState?this.targetWindow.document.addEventListener("DOMContentLoaded",e):this.targetWindow.setTimeout(e,0)}},{key:"fetchLazy",value:function(){var e=this;return this.config.isLazy()?this.getRenderingRequest().then(function(t){e.page=new u.default(t.resolved,e.appContext),e.page.render()}).catch(function(t){console.error(t),e.unmount()}):Promise.resolve()}},{key:"getRenderingRequest",value:function(){return this.opboxWebClient.getPageRenderingResult(this.targetWindow.location.href)}},{key:"unmount",value:function(){var e=this;this.config.lazyBoxNames.forEach(function(t){new c.default({name:t},e.appContext).unmount()})}},{key:"broadcastAPILoadEvent",value:function(){var e=(0,k.createEvent)("opboxAPILoaded",this.targetWindow);this.targetWindow.dispatchEvent(e)}},{key:"attach",value:function(){var e=this,t=o.default.getGlobal(this.targetWindow),n=this.API;t&&((0,P.default)(t,n,function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return o.default.assignToGlobal(e.targetWindow,k.assignToTarget.apply(void 0,[t,n].concat(i)))}),(0,k.dropUnknownKeys)(t,o.default.getWhitelist(n)),Object.freeze(t)),this.config.pinter.enabled&&(this.pinterInstance=(0,x.default)(this.config.pinter.samplingRate)),this.broadcastAPILoadEvent()}},{key:"sendPerformanceMetrics",value:function(){this.pinterInstance&&this.pinterInstance.sendUserTimings&&this.pinterInstance.sendUserTimings()}},{key:"run",value:function(){return this.attach(),this.fetchLazy()}},{key:"API",get:function(){return{analytics:this.analytics.createAPI(),boxViewsMarker:this.boxViewsMarker.createAPI(),component:this.component.createAPI(),onData:this.rawDataListenersRegistry.registerListener.bind(this.rawDataListenersRegistry),changeParams:this.navigation.navigateRelative.bind(this.navigation),refreshPage:this.navigation.refreshPage.bind(this.navigation),tween:this.uiTools.tween.bind(this.uiTools),scrollTo:this.uiTools.scrollTo.bind(this.uiTools),page:this.opboxWebClient.createAPI(),edge:this.edgeClient.createAPI(),preferences:this.preferencesClient.createAPI(),registerComponent:this.registerComponent.bind(this),onDomReady:this.domReadyHelper.bind(this),loaded:!0}}}]),e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.baseDomain,i=n.edgeHost,o=n.lazyBoxNames,a=void 0===o?[]:o,s=n.cookieMonster,u=void 0===s?{}:s,c=n.pinter,l=void 0===c?{}:c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isLazy=function(){return t.lazyBoxNames.length>0},this.baseDomain=r,this.edgeHost=i,this.lazyBoxNames=a,this.cookieMonster=u,this.pinter=l}return r(e,null,[{key:"getGlobal",value:function(e){return e.opbox||{}}},{key:"fromWindow",value:function(t){return new e(e.getGlobal(t).config)}},{key:"assignToGlobal",value:function(e,t){e.opbox=e.opbox||{},Object.assign(e.opbox,t)}},{key:"getWhitelist",value:function(e){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Object.keys(e)),["initialized","config"])}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(15)),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.boxPrototypes={}}return r(e,[{key:"register",value:function(e,t,n,r){var o=this.boxPrototypes[e]||{};o[t]=new i.default(n,r),this.boxPrototypes[e]=o}},{key:"find",value:function(e,t){var n=this.boxPrototypes[e];if(!n)return null;for(var r=Object.keys(n),i=0;i<r.length;i+=1){var o=parseFloat(r[i]),a=parseFloat(r[i+1]),s=parseFloat(t);if(o<=s&&(!a||a>s))return n[r[i]]}return null}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.noop,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.didMount,o=void 0===i?r.noop:i,a=n.didUnmount,s=void 0===a?r.noop:a;!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.render=t,this.didMount=o,this.didUnmount=s}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),o=r(n(1)),a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.parameterResolver=new o.default(n),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(5)),o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"wrap",value:function(e){return"<div "+('data-box-name="'+this.name+'" data-prototype-id="'+this.prototypeId+'"')+' data-expand="1" class="lazyload" '+('data-analytics-enabled data-analytics-category="'+this.prototypeId+'" data-analytics-tags="'+this.analyticsTags+'"')+'><a name="'+this.slug+'"></a>'+e+"</div>"}},{key:"render",value:function(){var e=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this);return this.wrap(e)}}]),t}();t.default=o},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,r=t.boxes,i=void 0===r?[]:r,o=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=o.ChildBox;this.name=n,this.boxes=i.map(function(e){return new a(e,o)})}return i(e,[{key:"render",value:function(){return this.boxes.map(function(e){return e.render()}).join("")}},{key:"didMount",value:function(){this.boxes.forEach(function(e){e.didMount()})}},{key:"didUnmount",value:function(){this.boxes.forEach(function(e){e.didUnmount()})}},{key:"childBoxes",get:function(){var e;return(e=[]).concat.apply(e,r(this.boxes.map(function(e){var t;return(t=[e]).concat.apply(t,r(e.childBoxes))})))}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return e>=200&&e<300||502===e}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(20)),s=r(n(21)),u=r(n(6)),c=r(n(22)),l=r(n(7)),f=function(){function e(t){var n=t.httpClient;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.httpClient=n}return o(e,[{key:"getPageData",value:function(e){var t={headers:{Accept:"application/vnd.opbox-web.v2+json"},cancelLast:!0,validateStatus:i};return this.httpClient.get(e,t).then(function(e){var t=new u.default(e);if(!t.valid)throw new a.default("Opbox response is invalid.");return new l.default(t.data)})}},{key:"getPageRenderingResult",value:function(t){var n={headers:{Accept:"application/vnd.opbox-web.v3+json"},cancelLast:!0,validateStatus:i};return this.httpClient.get(t,n).then(function(t){return e.mapPageRenderingResponse(t)})}},{key:"createAPI",value:function(){return{getData:this.getPageData.bind(this)}}}],[{key:"mapPageRenderingResponse",value:function(e){var t=new s.default(e);if(!t.valid)throw new a.default("Page rendering response is invalid.");var n=t.renderingResult,r=t.renderingContext;return new c.default(n,r)}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.message=e,n.name="PageRenderingError",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(6)),o=n(0),a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"valid",get:function(){return function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"valid",this)&&(0,o.isObject)(this.headers)&&(0,o.isObject)(this.renderingResult)&&t.allowedStatuses.indexOf(this.renderingStatus)>=0}},{key:"renderingResult",get:function(){return this.data.pageRenderingResult}},{key:"renderingStatus",get:function(){return this.data.renderingStatus}},{key:"renderingContext",get:function(){return JSON.parse(this.headers["page-context"])}}],[{key:"allowedStatuses",get:function(){return["OK","DATA_SOURCE_ERRORS"]}}]),t}();t.default=a},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t.boxes,i=void 0===r?[]:r,a=t.dataSources,s=void 0===a?[]:a,u=t.parameters,c=void 0===u?[]:u,l=t.locale,f=t.pageUrl,d=t.canonicalUrl,h=n.edgeHost,v=n.env,p=n.isDirect,y=n.renderDateTime;this.boxes=i,this.dataSources=s,this.context={locale:l,pageUrl:f,canonicalUrl:d,edgeHost:h,env:v,isDirect:p,renderDateTime:y},this.parameters=c,this.parameterResolver=new o.default(this.resolvedDataSources)}return i(e,[{key:"resolvedDataSources",get:function(){return this.dataSources.reduce(function(e,t){return Object.assign(e,r({},t.name,t))},{})}},{key:"resolvedMeta",get:function(){var e=this,t=Object.keys(this.context).reduce(function(t,n){return Object.assign(t,r({},"$page."+n,e.context[n]))},{}),n=this.parameters.reduce(function(t,n){return Object.assign(t,e.parameterResolver.resolve(n,n.name))},{});return Object.assign({},t,n)}},{key:"resolved",get:function(){return{boxes:this.boxes,dataSources:this.resolvedDataSources,meta:this.resolvedMeta}}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=r(n(7)),a=r(n(4)),s=n(0),u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appContext=t,this.rawData=o.default.createEmpty(),this.listeners={},this.analytics=n}return i(e,[{key:"registerListener",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.noop,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.noop;if(this.rawData.boxes[e]){var r=this.rawData.resolved.boxes[e];setTimeout(function(){t(r)},0)}this.listeners[e]={onChange:t,onProgress:n}}},{key:"triggerChangeListener",value:function(e){var t=this;this.rawData=e;var n=this.rawData.resolved,r=n.boxes,i=n.meta;Object.keys(r).forEach(function(e){var n=r[e];if(!(0,s.isUndefined)(n)){var i=t.listeners[e];i&&(0,s.isFunction)(i.onChange)&&setTimeout(function(){return i.onChange(n)},0)}});var o=i.pageViewAnalyticsContext,u=void 0===o?{}:o;this.analytics&&Object.keys(u).length&&this.analytics.updateCustomParams({pv:u});new a.default({meta:i},this.appContext).render()}},{key:"triggerProgressListener",value:function(){var e=this;Object.keys(this.listeners).forEach(function(t){var n=e.listeners[t];n&&(0,s.isFunction)(n.onProgress)&&setTimeout(function(){return n.onProgress()},0)})}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e,t,n){return e.addEventListener(t,n),{remove:function(){e.removeEventListener(t,n)}}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),a=n(8),s=n(0),u=function(){function e(t){var n=t.targetWindow,r=t.config,i=t.cookieMonsterClient,o=t.boxViewsMarker,a=t.sendPerformanceMetrics;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var u=r.cookieMonster,c=(u=void 0===u?{}:u).boxViewDisabled,l=u.defaultCustomParams,f=void 0===l?{}:l;this.targetWindow=n,this.document=this.targetWindow.document,this.boxViewDisabled=c,this.cookieMonsterClient=i,this.boxViewsMarker=o,this.defaultCustomParams=f,this.eventCallbacks=[],this.sendPerformanceMetrics=a||s.noop}return i(e,[{key:"initialize",value:function(){this.cookieMonsterClient.initialize(),this.eventHandlers=[r(this.document,"change",this.handleChange.bind(this)),r(this.document,"click",this.handleClick.bind(this)),r(this.document,"mousedown",this.handleLinkClick.bind(this)),r(this.document,"submit",this.handleSubmit.bind(this)),r(this.document,"contextmenu",this.handleClick.bind(this)),r(this.document,"boxView",this.handleBoxView.bind(this)),r(this.targetWindow,"DOMContentLoaded",this.detectAdblock.bind(this))]}},{key:"teardown",value:function(){this.eventHandlers.forEach(function(e){e.remove()})}},{key:"sendEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.contextNode,r=t.action,i=t.label,a=void 0===i?"":i,s=t.value,u=t.customParams,c=void 0===u?{}:u;if(!n||!r)return{};var l=n.closest("[data-analytics-category]").getAttribute("data-analytics-category"),f=n.closest("[data-box-name]").getAttribute("data-box-name"),d=e.extractAnalyticsTags(n),h=e.extractGroups(n),v=d.length?{analyticsTags:d}:{},p=h.length?{groups:h}:{},y=Object.assign({},v,p,{boxName:f}),m={category:l,action:r,label:a,value:s,customParams:(0,o.default)(c,{_opbox:y},this.defaultCustomParams.ev)};return this.cookieMonsterClient.send("event",m),this.eventCallbacks.length&&this.eventCallbacks.forEach(function(e){return e(m)}),m}},{key:"sendClickEvent",value:function(e){this.sendEvent(Object.assign({},e,{action:"click"}))}},{key:"sendContextmenuEvent",value:function(e){this.sendEvent(Object.assign({},e,{action:"contextmenu"}))}},{key:"sendBoxInteractionEvent",value:function(e){this.sendEvent(Object.assign({},e,{action:"boxInteraction"}))}},{key:"sendItemViewEvent",value:function(e){this.sendEvent(Object.assign({},e,{action:"itemView"}))}},{key:"sendBoxViewEvent",value:function(e){this.sendEvent(Object.assign({},e,{action:"boxView"}))}},{key:"sendFormSubmitEvent",value:function(e){this.sendEvent(Object.assign({},e,{action:"submit"}))}},{key:"detectAdblock",value:function(){var e=this,t=document.createElement("div");t.innerHTML="&nbsp;",t.className="adsbox",this.document.body.appendChild(t),this.targetWindow.setTimeout(function(){var n=0!==t.offsetHeight;e.cookieMonsterClient.send("event",{category:"clearPV",action:n,customParams:e.defaultCustomParams.ev}),e.document.body.removeChild(t)},100)}},{key:"handleClick",value:function(e){this.handleBoxInteraction(e),this.handleLinkClick(e)}},{key:"handleBoxInteraction",value:function(t){if("function"==typeof t.target.closest){var n=t.target.closest("[data-analytics-interaction]");if(n){var r=e.getCustomParamsForInteraction({contextNode:n}),i=n.getAttribute("data-analytics-interaction-label")||"",o=n.getAttribute("data-analytics-interaction-value")||n.textContent.trim();this.sendBoxInteractionEvent({contextNode:n,label:i,value:o,customParams:r})}}}},{key:"handleLinkClick",value:function(t){if("function"==typeof t.target.closest){var n=t.target.closest("a");if(n&&n.hasAttribute("data-analytics-clickable")){var r=n.getAttribute("data-analytics-click-label")||"",i=n.getAttribute("data-analytics-click-value")||n.textContent.trim(),o=n.getAttribute("href"),a=t.pageX?{pageX:t.pageX,pageY:t.pageY}:{},s=e.getCustomParamsForClick({contextNode:n,coordinates:a,destinationUrl:o});"click"!==t.type||0!==t.button?"contextmenu"!==t.type?"mousedown"===t.type&&1===t.button&&this.sendClickEvent({contextNode:n,label:r,value:i,customParams:s}):this.sendContextmenuEvent({contextNode:n,label:r,value:i,customParams:s}):this.sendClickEvent({contextNode:n,label:r,value:i,customParams:s})}}}},{key:"handleChange",value:function(t){var n=t.target;if("select-one"===n.type&&n&&n.hasAttribute("data-analytics-selectable")){var r=n.options[n.selectedIndex].value,i=e.extractCustomParams(n,"data-analytics-select-custom-");this.sendEvent({contextNode:n,action:"change",value:r,customParams:i})}}},{key:"handleSubmit",value:function(e){var t=e.target;if(t&&"FORM"===t.nodeName&&t.hasAttribute("data-analytics-submittable")){var n=t.getAttribute("action"),r=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.elements)).filter(function(e){return e.name}).map(function(e){return{name:e.name,value:e.value}}).sort(function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())}).map(function(e){return e.name+"="+e.value}).join("&"),i=(r=r?"?"+r:"")?n+r:n;i=encodeURI(i),this.sendFormSubmitEvent({contextNode:t,value:i,label:"submitForm"})}}},{key:"markParentBoxAsVisible",value:function(e){var t=e.parentNode&&e.parentNode.closest("[data-analytics-enabled]");this.boxViewsMarker&&t&&!t.hasAttribute(a.SEEN_ATTRIBUTE_NAME)&&this.boxViewsMarker.markBoxAsVisible(t,!0)}},{key:"handleBoxView",value:function(t){var n=t.target;if(n&&n.hasAttribute("data-analytics-enabled")&&(!this.boxViewDisabled||n.hasAttribute("data-item"))&&!e.hasFragmentAsImmediateChild(n)){var r=n.getAttribute("data-analytics-view-value")||"",i=n.getAttribute("data-analytics-view-label")||"",o=e.getCustomParamsForView({contextNode:n});if(n.firstChild&&n.firstChild.nodeType===Node.ELEMENT_NODE&&Object.assign(o,e.extractCustomParams(n.firstChild,"data-analytics-view-custom-")),n.hasAttribute("data-item"))return this.markParentBoxAsVisible(n),void this.sendItemViewEvent({contextNode:n,label:i,value:r,customParams:o});Object.assign(o,e.extractBoxViewCustomParams(n)),this.sendBoxViewEvent({contextNode:n,value:r,customParams:o})}}},{key:"sendPageViewProxy",value:function(){this.sendPerformanceMetrics(),this.cookieMonsterClient.sendPageView(),this.cookieMonsterClient.updateReferrer()}},{key:"sendEventProxy",value:function(e,t,n,r){return e.nodeType===Node.ELEMENT_NODE?this.sendEvent({contextNode:e,action:t,value:n,customParams:r}):this.sendEvent(e)}},{key:"sendItemViewEventProxy",value:function(t){var n=t.contextNode,r=t.label,i=t.value,o=t.customParams;this.sendItemViewEvent({contextNode:n,label:r,value:i,customParams:e.getCustomParamsForView({contextNode:n,customParams:o})})}},{key:"sendClickEventProxy",value:function(t){var n=t.contextNode,r=t.label,i=t.value,o=t.customParams,a=t.destinationUrl;this.sendClickEvent({contextNode:n,label:r,value:i,customParams:e.getCustomParamsForClick({contextNode:n,destinationUrl:a,customParams:o})})}},{key:"sendContextmenuEventProxy",value:function(t){var n=t.contextNode,r=t.label,i=t.value,o=t.customParams,a=t.destinationUrl;this.sendContextmenuEvent({contextNode:n,label:r,value:i,customParams:e.getCustomParamsForClick({contextNode:n,destinationUrl:a,customParams:o})})}},{key:"sendBoxInteractionEventProxy",value:function(t){var n=t.contextNode,r=t.label,i=t.value,o=t.customParams;this.sendBoxInteractionEvent({contextNode:n,label:r,value:i,customParams:e.getCustomParamsForInteraction({contextNode:n,customParams:o})})}},{key:"updateCustomParams",value:function(e){var t=e.pv,n=void 0===t?{}:t,r=e.ev,i=void 0===r?{}:r;(0,s.isObject)(n)&&(0,s.isObject)(i)?this.cookieMonsterClient.updateCustomParams({pv:n,ev:i}):console.log("Can not update custom params with non-object arguments!")}},{key:"registerEventCallback",value:function(e){e&&!this.eventCallbacks.includes(e)&&this.eventCallbacks.push(e)}},{key:"createAPI",value:function(){return{sendPageView:this.sendPageViewProxy.bind(this),sendEvent:this.sendEventProxy.bind(this),sendItemViewEvent:this.sendItemViewEventProxy.bind(this),sendClickEvent:this.sendClickEventProxy.bind(this),sendContextmenuEvent:this.sendContextmenuEventProxy.bind(this),sendBoxInteractionEvent:this.sendBoxInteractionEventProxy.bind(this),registerEventCallback:this.registerEventCallback.bind(this)}}}],[{key:"toCamelCase",value:function(e){return e.replace(/^([A-Z])|[\s|_-](\w)/g,function(e,t,n){return n?n.toUpperCase():t.toLowerCase()})}},{key:"getCustomParamsForView",value:function(t){var n=t.contextNode,r=t.customParams,i=void 0===r?{}:r,a=e.extractCustomParams(n,"data-analytics-view-opbox-custom-"),s=Object.keys(a).length?{_opbox:a}:{};return(0,o.default)(e.extractCustomParams(n,"data-analytics-view-custom-"),s,i)}},{key:"getCustomParamsForClick",value:function(t){var n=t.contextNode,r=t.coordinates,i=void 0===r?{}:r,a=t.destinationUrl,s=void 0===a?"":a,u=t.customParams,c=void 0===u?{}:u,l=Object.assign(e.extractCustomParams(n,"data-analytics-click-opbox-custom-"),{destinationUrl:s},i);return(0,o.default)(e.extractCustomParams(n,"data-analytics-click-custom-"),{_opbox:l},c)}},{key:"getCustomParamsForInteraction",value:function(t){var n=t.contextNode,r=t.customParams,i=void 0===r?{}:r,a=e.extractCustomParams(n,"data-analytics-interaction-custom-"),s=e.extractCustomParams(n,"data-analytics-interaction-opbox-custom-"),u=Object.keys(s).length?{_opbox:s}:{};return(0,o.default)(a,u,i)}},{key:"extractCustomParams",value:function(t,n){for(var r={},i=0;i<t.attributes.length;i+=1){var o=t.attributes[i];if(0===o.name.indexOf(n)){var a=o.name.replace(n,"");r[e.toCamelCase(a)]=o.value}}return r}},{key:"extractBoxViewCustomParams",value:function(e){if(!e)return{};var t=e.getAttribute("data-analytics-box-view-custom-params");if(!t)return{};var n={};try{n=JSON.parse(decodeURIComponent(t))}catch(e){console.log(e)}return n}},{key:"extractAnalyticsTags",value:function(e){var t=e.closest("[data-analytics-tags]");return(t?t.getAttribute("data-analytics-tags"):"").length?t.getAttribute("data-analytics-tags").split(" "):[]}},{key:"extractGroups",value:function(e){var t=e.closest("[data-analytics-groups]");if(t){var n=decodeURIComponent(t.getAttribute("data-analytics-groups"));try{n=JSON.parse(n)}catch(e){return console.log("JSON.parse error! Can not convert "+n+" to JSON."),[]}return n}return[]}},{key:"hasFragmentAsImmediateChild",value:function(e){return Array.prototype.slice.call(e.childNodes,0).some(function(e){return e.classList&&e.classList.contains("opbox-fragment")})}}]),e}();t.default=u},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).targetWindow;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetWindow=t}return r(e,[{key:"getDomNodes",value:function(e){var t=this.targetWindow.document.querySelectorAll('[data-prototype-id="'+e+'"]');return t?Array.from(t):[]}},{key:"init",value:function(e,t){var n=e.prototypeName;n&&t({domNodes:this.getDomNodes(n)})}},{key:"createAPI",value:function(){return{init:this.init.bind(this)}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(0),a="missing edge host",s=function(){function e(t){var n=this,r=t.httpClient,i=t.config,o=void 0===i?{}:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.get=function(e,t){return n.edgeHost?n.httpClient.get(n.prepareRequestUrl(e),n.prepareRequestSettings(t)):Promise.reject(a)},this.put=function(e,t,r){return n.edgeHost?n.httpClient.put(n.prepareRequestUrl(e),t,n.prepareRequestSettings(r)):Promise.reject(a)},this.post=function(e,t,r){return n.edgeHost?n.httpClient.post(n.prepareRequestUrl(e),t,n.prepareRequestSettings(r)):Promise.reject(a)},this.patch=function(e,t,r){return n.edgeHost?n.httpClient.patch(n.prepareRequestUrl(e),t,n.prepareRequestSettings(r)):Promise.reject(a)},this.delete=function(e,t){return n.edgeHost?n.httpClient.delete(n.prepareRequestUrl(e),n.prepareRequestSettings(t)):Promise.reject(a)},this.httpClient=r,this.edgeHost=o.edgeHost,this.defaultRequestSettings={headers:{"Content-type":"application/vnd.allegro.public.v1+json",Accept:"application/vnd.allegro.public.v1+json"}}}return r(e,[{key:"prepareRequestSettings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.disableDefaultHeaders)return e;var t=this.normalizeSettings(e);return(0,i.default)({},this.defaultRequestSettings,t)}},{key:"normalizeSettings",value:function(e){if(!e||!e.headers)return e;var t=(0,o.normalizeObjectKeys)(e.headers,Object.keys(this.defaultRequestSettings.headers));return Object.assign(e,{headers:t})}},{key:"prepareRequestUrl",value:function(e){return this.edgeHost+e}},{key:"createAPI",value:function(){return{get:this.get,put:this.put,post:this.post,patch:this.patch,delete:this.delete}}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=function(){function e(t){var n=t.targetWindow,r=t.alias,i=void 0===r?"cm":r,o=t.config,a=void 0===o?{}:o,s=t.isExternal,u=void 0!==s&&s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var c=a.cookieMonster,l=c.host,f=c.account,d=c.defaultCustomParams,h=void 0===d?{}:d,v=c.referrer,p=void 0===v?document.referrer:v;this.targetWindow=n,this.document=this.targetWindow.document,this.alias=i,this.host=l,this.account=f,this.isExternal=u,this.defaultCustomParams=h,this.referrer=p}return r(e,[{key:"initialize",value:function(){if(this.isExternal)return this.loadExternal(),void this.callCookieMonster.call(this,"create",this.account);this.host&&this.account&&!this.isLoaded()?(this.load(),this.callCookieMonster.call(this,"create",this.account),this.sendPageView(),this.updateReferrer()):this.updateReferrer()}},{key:"load",value:function(){this.isLoaded()||function(e,t,n,r,i){e["cm.analytics.object"]=i,e[i]=e[i]||function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];(e[i].q=e[i].q||[]).push(n)};var o=t.createElement("script"),a=t.getElementsByTagName("script")[0];o.async=1,o.src=r,a.parentNode.insertBefore(o,a)}(this.targetWindow,this.document,0,this.host,this.alias)}},{key:"loadExternal",value:function(){this.isLoaded()||function(e,t){e["cm.analytics.object"]=t,e[t]=e[t]||function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];(e[t].q=e[t].q||[]).push(r)}}(this.targetWindow,this.alias)}},{key:"updateCustomParams",value:function(e){this.defaultCustomParams=(0,i.default)({},this.defaultCustomParams,e)}},{key:"send",value:function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this.callCookieMonster).call.apply(e,[this,this.sendCommand()].concat(n))}},{key:"sendPageView",value:function(){this.send("pageview",{customParams:this.defaultCustomParams.pv,referrer:this.referrer})}},{key:"updateReferrer",value:function(){this.referrer=window.location.href}},{key:"callCookieMonster",value:function(){if(this.isLoaded()){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.targetWindow[this.alias].apply(null,t)}}},{key:"isLoaded",value:function(){return"function"==typeof this.targetWindow[this.alias]}},{key:"sendCommand",value:function(){return"send@"+this.account}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=function(){function e(t){var n=t.targetWindow,r=t.opboxWebClient,i=t.rawDataListenersRegistry;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetWindow=n,this.opboxWebClient=r,this.rawDataListenersRegistry=i,this.history=[n.location.pathname],this.recentlyFetchedURL=e.getPageUrlFromTarget(n.location)}return i(e,[{key:"initialize",value:function(){var e=this;this.targetWindow.onpopstate=function(t){return e.handlePopState(t)},this.targetWindow.history.replaceState({opboxjs:!0},"")}},{key:"isInternalNavigation",value:function(e){return this.history.find(function(t){return t===e})}},{key:"navigateRelative",value:function(t){var n=this.targetWindow.location,r=n.pathname,i=n.search,o=r+i,a=r+e.resolve(i,t);this.changeUrl(a),this.history.push(r),this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.mark&&this.targetWindow.performance.mark("clientSideNavigationStart"),a!==o&&this.fetch(a)}},{key:"refreshPage",value:function(){var e=this.targetWindow.location,t=e.pathname+e.search;this.fetch(t)}},{key:"changeUrl",value:function(e){return this.targetWindow.history.pushState("","",e)}},{key:"handlePopState",value:function(t){var n=t.target.location.pathname,r=e.getPageUrlFromTarget(t.target.location);this.isInternalNavigation(n)&&this.recentlyFetchedURL!==r&&this.refreshPage()}},{key:"fetch",value:function(t){var n=this;this.recentlyFetchedURL=e.getPageUrlFromTarget(this.targetWindow.location),this.rawDataListenersRegistry.triggerProgressListener(),this.opboxWebClient.getPageData(t).then(function(e){return n.rawDataListenersRegistry.triggerChangeListener(e)}).catch(function(e){return console.error(e)})}}],[{key:"getPageUrlFromTarget",value:function(e){return""+e.origin+e.pathname+e.search}},{key:"resolve",value:function(e,t){function n(e){for(var t=new RegExp("([^&=]+)=?([^&]*)","g"),n={},r=e.substring(e.indexOf("?")+1,e.length),i=void 0;i=t.exec(r);)!function(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}(n,decodeURIComponent(i[1]),decodeURIComponent("string"===i[1]?i[2].replace(/\+/g," "):i[2]));return n}function i(e){t.forEach(function(t){return function(e,t,n){e[t]=Array.isArray(n)?n:[n]}(e,t.name,t.value)})}function a(e){return Object.keys(e).map(function(t){return e[t].map(function(e){return[t,e]})}).reduce(o.concat,[]).reduce(function(e,t){var n=r(t,2),i=n[0],o=n[1];return null!==o&&void 0!==o?e+(e?"&":"?")+encodeURIComponent(i)+"="+encodeURIComponent(o):e},"")}var s=n(e),u=void 0,c=(0,o.find)(s,function(e){return function(t){return t.name===e}}("route"));return c&&0===c.value.indexOf("http")?(i(u=2===c.value.split("?").length?n(c.value.split("?")[1]):[]),c.value=c.value.split("?")[0]+a(u)):i(s),a(s)}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(32),o=function(){function e(t){var n=t.targetWindow;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetWindow=n,this.document=n.document}return r(e,[{key:"getBoxAnchorNode",value:function(e){return"string"!=typeof e?null:this.document.querySelector('a[name="'+e+'"]')}},{key:"getTopOffset",value:function(e){var t=this.targetWindow.pageYOffset||this.document.documentElement.scrollTop||0;return e?e.getBoundingClientRect().top+t:null}},{key:"scrollTo",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).animate,n={duration:void 0===t||t?500:0};if("number"!=typeof e){var r=this.getBoxAnchorNode(e);if(r){var o=this.getTopOffset(r);(0,i.scroll)(this.targetWindow,o,n)}}else(0,i.scroll)(this.targetWindow,e,n)}},{key:"tween",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.tween.apply(void 0,[this.targetWindow].concat(t))}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},u=o.duration,c=void 0===u?i:u,l=o.onFinish;if("function"!=typeof r)return null;var f=s(e),d=Date.now(),h=n-t,v=!1;return function e(){var n=Date.now()-d;if(v||n>=c)"function"==typeof l&&l(),v=!1;else{var i=Math.min(n/c,1),o=a.easeInOutQuart(i)*h+t;r(o),f(e)}}(),{stop:function(){v=!0}}}Object.defineProperty(t,"__esModule",{value:!0}),t.tween=r,t.scroll=function(e){function t(){e[o]&&"function"==typeof e[o].stop&&(e[o].stop(),e[o]=null)}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).duration,s=void 0===a?i:a,u=e.pageYOffset,c=Math.max(0,n),l=e.document.body.scrollHeight;t(),e[o]=r(e,u,n,function(n){e.scrollTo(0,Math.round(n)),function(t){var n=t===c||t===c,r=e.innerHeight+t>=l;return n||r}(n)&&t()},{duration:s})};var i=500,o="opboxAnimationTimerInterval",a={easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e}},s=function(e){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(e){setTimeout(e,1e3/60)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{return r.default.create(window,{pageName:function(){var e=window.dataLayer;return e&&e[0]&&e[0].pageType||null}()||window.location.pathname.split("/").slice(0,2).join("/"),sendInterval:i,samplingThreshold:function(e){return Math.floor(e*o)}(e)})}catch(e){}return null};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(34)),i=500,o=16},function(e,t,n){"use strict";function r(e){for(var t=0,n=Date.now();t<g&&Date.now()-n<e;)t++;return t}function i(e){return"number"==typeof e&&e>=0?Math.min(Math.round(1e3*e),x):-1}function o(e,t){var n=e.getEntriesByType(P).filter(function(e){return e.name===t});return n.length>0?Math.round(n[0].startTime):-1}function a(e,t,n){return function(e,t){var n=function(e,t){var n=t.reduce(function(e,t){return e[t.href||t.src]=!0,e},{});return e.filter(function(e){return!0===n[e.name]})}(e,t),r=n.reduce(function(e,t){return{encodedBodySize:e.encodedBodySize+(t.encodedBodySize||0),transferSize:e.transferSize+(t.transferSize||0)}},{encodedBodySize:0,transferSize:0}),i=function(e){var t=0,r=0,i=0;return n.forEach(function(e){e.transferSize>0?r++:e.encodedBodySize>0?t++:i++}),{hits:t,misses:r,unknown:i}}();return{totalEncodedBodySize:r.encodedBodySize,totalTransferSize:r.transferSize,cacheHits:i.hits,cacheMisses:i.misses,cacheStatusUnknown:i.unknown}}(t,Array.prototype.slice.call(e.querySelectorAll(n)))}function s(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function u(e){return[e.cacheHits,e.cacheMisses,e.cacheStatusUnknown,e.totalEncodedBodySize,e.totalTransferSize]}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=1,v=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],p=0,y=-1,m=function(){function e(t){l(this,e),this.performance=t,this.processedMarks={}}return f(e,[{key:"getUserTimings",value:function(){var t=this;if(!this.isUserTimingSupported())return[];var n=this.performance.getEntriesByType("mark").filter(function(n){return!e.isBlacklisted(n)&&!t.hasBeenProcessed(n)}).sort(function(e,t){return e.startTime-t.startTime});if(0===n.length)return n;var r=function(e,t){return t.reduce(function(t,n){var r=d(t,2),i=r[0],o=r[1];return e(n)?[i.concat([n]),o]:[i,o.concat([n])]},[[],[]])}(function(e){return"clientSideNavigationStart"===e.name},n),i=d(r,2),o=i[0],a=i[1];return n.forEach(function(e){return t.saveAsProcessed(e)}),o.length>0?(this.lastClientSideNavigationStartTime=function(e){return e[e.length-1]}(o).startTime,a.map(function(t){var n=function(e,t){for(var n=t.length-1;n>=0;n--){var r=t[n];if(e(r,n,t))return r}return null}(function(e){return e.startTime<t.startTime},o);return n?Object.assign({},e.markToPojo(t),{startTime:t.startTime-n.startTime}):e.markToPojo(t)})):this.lastClientSideNavigationStartTime?n.map(function(n){return Object.assign({},e.markToPojo(n),{startTime:n.startTime-t.lastClientSideNavigationStartTime})}):n.map(function(t){return e.markToPojo(t)})}},{key:"isUserTimingSupported",value:function(){return"object"===c(this.performance)&&"function"==typeof this.performance.getEntriesByType}},{key:"saveAsProcessed",value:function(t){this.processedMarks[e.entryHash(t)]=1}},{key:"hasBeenProcessed",value:function(t){return e.entryHash(t)in this.processedMarks}}],[{key:"isBlacklisted",value:function(e){return"optimizely:"===e.name.substring(0,"optimizely:".length)}},{key:"entryHash",value:function(e){return e.name+"###"+e.entryType+"###"+e.startTime+"###"+e.duration}},{key:"markToEvent",value:function(e){return{category:"Performance",value:e.name,label:"Mark",customParams:{st:Math.round(e.startTime)}}}},{key:"markToPojo",value:function(e){return{duration:e.duration,entryType:e.entryType,name:e.name,startTime:e.startTime}}}]),e}(),g=5e3,b=10,w=40,k="navigation",x=1e6,P="paint",E="resource",_=["allegro.pl","assets.allegrostatic.pl","cdn.allegrostatic.com","assets.allegrostatic.com"],O=1,j=function(){function e(t,n,r){l(this,e),this.document=t.document,this.navigator=t.navigator,this.performance=t.performance,this.sender=r,this.pageName=n,this.userTiming=new m(this.performance)}return f(e,[{key:"sendNavigationTiming",value:function(){this.sendEvent(function(e,t){return function(e){return"object"===(void 0===e?"undefined":c(e))&&"object"===c(e.timing)}(e)?{category:"Performance",label:"NavigationTiming",customParams:{m:function(e){var t=function(t){var n=e.timing,r=void 0===n?{}:n;return v.map(function(e){return{name:e,value:r[e]}})}(),n=t[0].value;return t.slice(1).map(function(e){return function(e,t){var n=t-e;return!t||t<p||e<p||n<p?y:n}(n,e.value)})}(e),v:h,page:t}}:null}(this.performance,this.pageName))}},{key:"sendUserTimings",value:function(){var e=this;this.userTiming.getUserTimings().map(m.markToEvent).forEach(function(t){return e.sendEvent(t)})}},{key:"sendResourceInformation",value:function(){this.sendEvent(function(e,t,n){var l=(r(b),{benchmarkScore:r(w)}),f=function(e,t){if(!function(e){return"object"===(void 0===e?"undefined":c(e))&&"function"==typeof e.getEntriesByType}(t))return null;var n=t.getEntriesByType(k)[0];return{domElementsCount:e.getElementsByTagName("*").length,htmlLength:e.documentElement.innerHTML.length,encodedBodySize:n?n.encodedBodySize:-1,transferSize:n?n.transferSize:-1}}(e,n)||{},d=function(e){if(!function(e){return"object"===c(e.connection)}(e))return null;var t=e.connection,n=t.type,r=void 0===n?"":n,o=t.effectiveType,a=void 0===o?"":o,s=t.downlinkMax,u=void 0===s?-1:s,l=t.downlink,f=void 0===l?-1:l,d=t.rtt,h=void 0===d?-1:d;return{connectionType:r,connectionEffectiveType:a,connectionDownlinkMax:i(u),connectionDownlink:i(f),connectionRtt:h}}(t)||{},h=function(e){return function(e){return"object"===(void 0===e?"undefined":c(e))&&"function"==typeof e.getEntriesByType}(e)?{firstPaint:o(e,"first-paint"),firstContentfulPaint:o(e,"first-contentful-paint")}:null}(n)||{},v=function(e,t){if(!function(e,t){return"object"===(void 0===t?"undefined":c(t))&&"function"==typeof t.getEntriesByType&&"function"==typeof e.querySelectorAll}(e,t))return null;var n=t.getEntriesByType(E),r=n.filter(function(e){return"link"===e.initiatorType}),i=function(e){var t=[],n=[];return e.forEach(function(e){for(var r=0;r<_.length;r++){var i=_[r];if(0===e.name.indexOf("https://"+i+"/")){t.push(e);break}}r===_.length&&n.push(e)}),{internal:t,external:n}}(n.filter(function(e){return"script"===e.initiatorType})),o=n.filter(function(e){return"img"===e.initiatorType});return{styles:a(e,r,'link[rel="stylesheet"]'),internalScripts:a(e,i.internal,"script[src]"),externalScripts:a(e,i.external,"script[src]"),images:a(e,o,"img")}}(e,n)||{};return s(f)&&s(d)&&s(h)&&s(v)?null:{category:"Performance",label:"ResourceInformation",customParams:{v:O,bs:[l.benchmarkScore],ds:[f.domElementsCount,f.htmlLength,f.encodedBodySize,f.transferSize],nct:d.connectionType,net:d.connectionEffectiveType,ns:[d.connectionDownlinkMax,d.connectionDownlink,d.connectionRtt],ps:[h.firstPaint,h.firstContentfulPaint],tst:u(v.styles),tis:u(v.internalScripts),tes:u(v.externalScripts),tim:u(v.images)}}}(this.document,this.navigator,this.performance))}},{key:"sendEvent",value:function(e){null!==e&&this.sender.call(null,e)}}]),e}(),C=["regular","detail","user"],S={create:function(e,t){var n=t.pageName,r=void 0===n?"":n,i=t.sendInterval,o=void 0===i?500:i,a=t.samplingThreshold,s=void 0===a?16:a;if(!function(e,t,n){return-1===C.indexOf(n)||function(e,t){try{var n=function(e){return e.cookie.replace(/(?:(?:^|.*;\s*)_cmuid\s*=\s*([^;]*).*$)|^.*$/,"$1")}(e);return""===n?t>0:parseInt(n.charAt(0),16)<t}catch(e){return!1}}(e,t)}(e.document,s,r))return null;var u=new j(e,r,function(t){"function"==typeof e.cm?e.cm("send","event",t):"undefined"!=typeof console&&console.log("Cannot send performance data",t)});return"complete"===e.document.readyState?(u.sendNavigationTiming(),u.sendResourceInformation()):e.addEventListener("load",function(){e.setTimeout(function(){u.sendNavigationTiming(),u.sendResourceInformation()},0)}),e.setInterval(function(){u.sendUserTimings()},o),u.sendUserTimings(),u}};e.exports=S},function(e,t,n){"use strict";function r(e,t,n){for(var a=arguments.length,s=Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];if((0,o.isFunction)(e)&&(0,o.isFunction)(t)){if(!e.__queue__)return;!function(e,t){e.forEach(function(e){var n=e.args,r=e.reject,a=e.resolve,s=function(e,t){try{return e.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))}catch(e){return console.error(e),void("object"===i("NREUM")&&null!==NREUM&&"function"==typeof NREUM.noticeError&&NREUM.noticeError(e))}}(t,n);s&&(0,o.isFunction)(s.then)&&(0,o.isFunction)(a)&&(0,o.isFunction)(r)&&s.then(a,r)})}(e.__queue__,t),n.apply(void 0,[t].concat(s))}else(0,o.isObject)(e)&&(0,o.isObject)(t)&&Object.keys(e).forEach(function(i){r.apply(void 0,[e[i],t[i],n].concat([].concat(s,[i])))})}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=r;var o=n(0)},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(n(37)),c={withCredentials:!0,headers:{"Content-type":"application/vnd.allegro.internal.v1+json",Accept:"application/vnd.allegro.internal.v1+json"}},l=function(){function e(t){var n=t.edgeClient,r=t.localStorage,i=t.ttlMs;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.edgeClient=n,this.storage=new u.default({localStorage:r,ttlMs:i})}return s(e,[{key:"setPreference",value:function(e,t){var n={name:e,value:t};return this.storage.savePreferences([n]),this.edgeClient.post("/preferences",n,c)}},{key:"getPreference",value:function(e,t){return"string"==typeof e||e instanceof String?this.getPreferences(r({},e,t)).then(function(t){return t[e]}):Promise.reject(Error("illegal argument type provided as preference name"))}},{key:"getPreferences",value:function(e){var t=this;if("object"!==(void 0===e?"undefined":a(e)))return Promise.reject(Error("illegal argument type provided as preferences"));var n="/preferences?name="+Object.keys(e).join(",");return this.edgeClient.get(n,c).then(function(e){return t.storage.savePreferences(e.data.preferences),e.data.preferences.reduce(function(e,t){var n=t.name,i=t.value;return o({},e,r({},n,i))},{})}).catch(function(){return t.getPreferencesFromLocalStorageOrDefaults(e)})}},{key:"getPreferencesFromLocalStorageOrDefaults",value:function(e){this.storage.cleanupPreferences();var t=this.storage.loadPreferences();return Object.entries(e).reduce(function(e,n){var a=i(n,2),s=a[0],u=a[1];return o({},e,r({},s,s in t?t[s].value:u))},{})}},{key:"createAPI",value:function(){return{set:this.setPreference.bind(this),get:this.getPreference.bind(this),getMany:this.getPreferences.bind(this)}}}]),e}();t.default=l},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){var e=this;this.savePreferences=function(t){var n=e.loadPreferences(),i=e.timeProvider(),a=t.reduce(function(e,t){var n=t.name,a=t.value;return o({},e,r({},n,{value:a,timestamp:i}))},n);e.writeToStorage(a)},this.writeToStorage=function(t){try{e.storage.setItem(e.key,JSON.stringify(t))}catch(e){window.newrelic&&window.newrelic.noticeError(e)}},this.loadPreferences=function(){try{return JSON.parse(e.storage.getItem(e.key))||{}}catch(e){return window.newrelic&&window.newrelic.noticeError(e),{}}},this.cleanupPreferences=function(){var t=e.loadPreferences(),n=e.timeProvider(),a=Object.entries(t).reduce(function(t,a){var s=i(a,2),u=s[0],c=s[1];return c.timestamp+e.ttlMs>n?o({},t,r({},u,c)):t},{});e.writeToStorage(a)},this.isAvailable=function(e){try{var t="test_preferences_storage";return e.setItem(t,t),e.getItem(t),e.removeItem(t),!0}catch(e){return!1}}};t.default=function e(t){var n=t.localStorage,r=t.ttlMs,i=void 0===r?6048e5:r,o=t.key,s=void 0===o?"preferences":o,u=t.timeProvider,c=void 0===u?function(){return Date.now()}:u;!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),a.call(this),this.storage=this.isAvailable(n)?n:function(){return{setItem:function(){},getItem:function(){return{}}}},this.ttlMs=i,this.key=s,this.timeProvider=c}}]);